<!DOCTYPE html> 
<html lang="cn"> 
<head>
	<meta charset="UTF-8">
	<title>作业列表</title>
	<script src="{{url_for('static', filename='jquery-3.4.1.js')}}"></script>
	<style>
.table_title {
	font-weight: 600;
	text-align: center;
	font-family: monospace;
	padding-left: 12px;
	padding-right: 6px;
	background-color: #FFFFE0;
}
.cell {
	text-align: center;
	font-family: monospace;
	padding-left: 12px;
	padding-right: 6px;
	padding-top: 0px;
	padding-bottom: 0px;
	height: 48px;
}
.paper {
	width: 100%;
	margin: 0;
	font-family: monospace
}
.title {
	font-size: 1.6rem;
	font-weight: 800;
	text-align: center;
	margin-top: 30px;
	margin-bottom: 50px;
	height: 55px;
}
	</style>
	<script type="text/javascript">
	$(function(){
		$(".upload_button").click(function(){
			console.log($(this).prev());
			$(this).prev().click();
		})
		$(".file").change(function(){
			console.log($(this).parent());
			$(this).parent().submit();
		})
		var msg = $("#msg")[0].value;
		if(msg != "")
			alert(msg);
		console.log(msg);
	})
	</script>
</head>
<body class="paper">
	<input type="hidden" id="msg" value="{{msg}}"></input>
	<div class="title">
		Welcome, {{user.name}}
		({{user.id}}).
		<span style="float: right; font-size: 0.8rem; padding-top: 20px; padding-right: 15px;">
			<a href="{{ url_for('logout') }}">安全注销</a>
		</span>
		<span style="float: right; font-size: 0.8rem; padding-top: 20px; padding-right: 15px;">
			<a href="{{ url_for('modify_pwd') }}">修改密码</a>
		</span>
	</div>

	<table class="paper" border="1" cellspacing="0" cellpadding="0">
		<tr class="table_title">
			<td style="width: 25px;">序号</td>
			<td style="width: 30px; padding-left: 5px; padding-right: 5px;">截止时间</td>
			<td style="width: 30%">作业名称</td>
			<td>作业内容</td>
			<td style="width: 10%">操作</td>
		</tr>
		{% for hs in hss %}
		<tr class="cell" style="background-color: {{'pink' if now_timestamp > hs.timestamp else 'inherit'}};">
			<td style="width: 20px; font-size: 0.7rem;">{{loop.index}}</td>
			<td style="width: 20px; padding-left: 5px; padding-right: 5px;">{{hs.time}}</td>
			<td style="width: 30%; font-size: 1.0rem;">{{hs.name}}</td>
			<td style=
			"text-align: left; padding-left: 12px;  padding-right: 12px; height: {{14+18*(hs.description_list | length)}}px;">
				{% for desc in hs.description_list %}
				<div>{{ desc }}</div>
				{% endfor %}
			</td>
			<td style="width: 10%; padding-left: 12px;  padding-right: 12px;">
			{% if now_timestamp > hs.timestamp %}
				{% if hs.statu == "未提交" or hs.statu == "" %}
				<p>未提交</p>
				<form id="upload_form" action="{{ url_for('upload') }}" method="post" enctype="multipart/form-data">
					<input name="homework_id" type="hidden" value="{{hs.id}}"/>
					<input style="display: none;" name="file" type="file" class="file" />
					<input type="button" class="upload_button" style="display:inline" value="补交" />
				</form>
				{% else %}
				<form action="{{ url_for('download') }}" method="post">
					<input name="homework_id" type="hidden" value="{{hs.id}}"/>
					<button type="submit" style="display:inline">下载</button>
				</form>
				{% endif %}
			{% elif hs.statu == "未提交" or hs.statu == "" %}
			<form id="upload_form" action="{{ url_for('upload') }}" method="post" enctype="multipart/form-data">
				<input name="homework_id" type="hidden" value="{{hs.id}}"/>
				<input style="display: none;" name="file" type="file" class="file" />
				<input type="button" class="upload_button" style="display:inline" value="上传" />
			</form>
			{% elif hs.statu == "已提交" or hs.statu == "已补交" %}
				{% if hs.statu == "已补交" %}
				<p>已补交</p>
				{% endif %}
			<form action="{{ url_for('download') }}" method="post" style="display:inline">
				<input name="homework_id" type="hidden" value="{{hs.id}}"/>
				<button type="submit" style="display:inline">下载</button>
			</form>  
			<form id="upload_form" action="{{ url_for('upload') }}" method="post" enctype="multipart/form-data" style="display:inline">
				<input name="homework_id" type="hidden" value="{{hs.id}}"/>
				<input style="display: none;" name="file" type="file" class="file" />
				<input type="button" class="upload_button" style="display:inline" value="替换" />
			</form>
			{% else %}
			<label>Error Statu: {{hs.statu}}</label>
			{% endif %}
			</td>
		</tr>
		{% endfor %}
	</table>
</body>
</html> 